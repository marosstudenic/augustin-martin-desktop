---
const { type, prodname } = Astro.params;
const prodtype = type;
import Nav from "../../components/Nav.astro";
import MainHead from "../../components/MainHead.astro";
import NavDesktop from "../../components/NavDesktop.astro";
import NavMobile from "../../components/NavMobile.astro";
import Kontakt from "../../components/Kontakt.astro";

const products = {
  publikacie: {
    title: "Publikácie",
    slug: "publikacie",
    items: [
      {
        title: "KYTICE",
        slug: "kytice",
        author: "Karel Jaromír Erben",
        image: "produkty/kytice.jpg",
        descriptions: [
          "litografia",
          "23 × 23 cm, 252 stran",
          "290 €",
          "Dostupné cez <a target='_blank' href='https://www.luxusnakniznica.sk/kytice' class='text-gray-600 cursor-pointer hover:text-gray-900 underline'>luxusnakniznica.sk/kytice</a> (SK)",
          "Dostupné cez <a target='_blank' href='https://www.rosier.cz/' class='text-gray-600 cursor-pointer hover:text-gray-900 underline'>rosier.cz</a> (CZ)",
        ],
      },
      {
        title: "Obrazy, texty, sentencie",
        slug: "obrazy-texty-sentencie",
        image: "spoluprace/brozovanaPublikacia_obrazyTextySentencie.jpg",
        author: "Kamil Peteraj, Martin Augustín",
        descriptions: [
          "brožovaná publikácia",
          "40 strán, 38 x 30 cm",
          "40€ + poštovné",
        ],
      },
      {
        title: "Zrkadlo duše",
        slug: "zrkadlo-duse",
        author: "Martin Augustín, autor textu Ľudovít Petranský",
        image: "spoluprace/zrkadlo_duse.jpg",
        descriptions: [
          "monografia",
          "214 strán, 31 x 25,5 cm",
          "39€ + poštovné",
        ],
      },
      {
        title: "Máj",
        slug: "maj",
        author: "Hynek Karel Mácha",
        image: "produkty/obalka_knihy_maj.jpg",
        descriptions: [
          "22,54€ + poštovné",
          "Dostupné cez <a href='https://www.martinus.sk/?uItem=1548731&gclid=CjwKCAjw2f-VBhAsEiwAO4lNeCilwRS-' class='text-gray-600 cursor-pointer hover:text-gray-900 underline'>martinus.sk</a>",
        ],
      },
    ],
  },
  textilie: {
    title: "Textilie",
    slug: "textilie",
    items: [
      {
        title: "Hodvábna šatka s motívom obrazu Martina Augustína",
        slug: "hodvabna-satka",
        image: "produkty/hodvabnaSatka_detail.jpg",
        altImage: "produkty/hodvabnaSatkaObraz.jpg",
        descriptions: ["90 x 90 cm", "90€ + poštovné"],
      },
    ],
  },
  grafickeListy: {
    title: "Grafické listy",
    slug: "listy",
    items: [
      {
        title: "Slnko nad hlavou",
        slug: "slnko-nad-hlavou",
        image: "produkty/grafList_slnkoNadHlavou.jpg",
        descriptions: [
          "technika limitovaný ofset",
          "náklad 200 ks, 70 x 50 cm",
          "200€ + poštovné",
          "signovaný autormi Martinom Augustínom, Kamilom Peterajom\n",
        ],
      },
      {
        title: "Raz uvidíš",
        slug: "raz-uvidis",
        image: "produkty/grafList_razUvidis.jpg",
        descriptions: [
          "technika limitovaný ofset",
          "náklad 200 ks, 70 x 50 cm",
          "200€ + poštovné",
          "signovaný autormi Martinom Augustínom, Kamilom Peterajom\n",
        ],
      },
    ],
  },
  limitovaneEdicie: {
    title: "Limitované edície",
    slug: "limitovane",
    items: [
      {
        title: "Sen menom láska",
        slug: "sen-menom-laska",
        image: "produkty/limitovane_senMenomLaska.jpg",
        descriptions: [
          "limitovaná kniha poézie",
          "hodvábna šatka s dielom M. Augustína",
          "certifikát vlastníctva",
          "300€ + poštovné",
          "nedostupné",
        ],
      },
    ],
  },
};

export function getStaticPaths() {
  var products = {
    publikacie: {
      title: "Publikácie",
      slug: "publikacie",
      items: [
        {
          title: "KYTICE",
          slug: "kytice",
          author: "Karel Jaromír Erben",
          image: "produkty/kytice.jpg",
          descriptions: [
            "litografia",
            "23 × 23 cm, 252 stran",
            "290 €",
            "Dostupné cez <a target='_blank' href='https://www.luxusnakniznica.sk/kytice' class='text-gray-600 cursor-pointer hover:text-gray-900 underline'>luxusnakniznica.sk/kytice</a> (SK)",
            "Dostupné cez <a target='_blank' href='https://www.rosier.cz/' class='text-gray-600 cursor-pointer hover:text-gray-900 underline'>rosier.cz</a> (CZ)",
          ],
        },
        {
          title: "Obrazy, texty, sentencie",
          slug: "obrazy-texty-sentencie",
          image: "spoluprace/brozovanaPublikacia_obrazyTextySentencie.jpg",
          author: "Kamil Peteraj, Martin Augustín",
          descriptions: [
            "brožovaná publikácia",
            "40 strán, 38 x 30 cm",
            "40€ + poštovné",
          ],
        },
        {
          title: "Zrkadlo duše",
          slug: "zrkadlo-duse",
          author: "Martin Augustín, autor textu Ľudovít Petranský",
          image: "spoluprace/zrkadlo_duse.jpg",
          descriptions: [
            "monografia",
            "214 strán, 31 x 25,5 cm",
            "39€ + poštovné",
          ],
        },
        {
          title: "Máj",
          slug: "maj",
          author: "Hynek Karel Mácha",
          image: "produkty/obalka_knihy_maj.jpg",
          descriptions: [
            "22,54€ + poštovné",
            "Dostupné cez <a href='https://www.martinus.sk/?uItem=1548731&gclid=CjwKCAjw2f-VBhAsEiwAO4lNeCilwRS-' class='text-gray-600 cursor-pointer hover:text-gray-900 underline'>martinus.sk</a>",
          ],
        },
      ],
    },
    textilie: {
      title: "Textilie",
      slug: "textilie",
      items: [
        {
          title: "Hodvábna šatka s motívom obrazu Martina Augustína",
          slug: "hodvabna-satka",
          image: "produkty/hodvabnaSatka_detail.jpg",
          altImage: "produkty/hodvabnaSatkaObraz.jpg",
          descriptions: ["90 x 90 cm", "90€ + poštovné"],
        },
      ],
    },
    grafickeListy: {
      title: "Grafické listy",
      slug: "listy",
      items: [
        {
          title: "Slnko nad hlavou",
          slug: "slnko-nad-hlavou",
          image: "produkty/grafList_slnkoNadHlavou.jpg",
          descriptions: [
            "technika limitovaný ofset",
            "náklad 200 ks, 70 x 50 cm",
            "200€ + poštovné",
            "signovaný autormi Martinom Augustínom, Kamilom Peterajom\n",
          ],
        },
        {
          title: "Raz uvidíš",
          slug: "raz-uvidis",
          image: "produkty/grafList_razUvidis.jpg",
          descriptions: [
            "technika limitovaný ofset",
            "náklad 200 ks, 70 x 50 cm",
            "200€ + poštovné",
            "signovaný autormi Martinom Augustínom, Kamilom Peterajom\n",
          ],
        },
      ],
    },
    limitovaneEdicie: {
      title: "Limitované edície",
      slug: "limitovane",
      items: [
        {
          title: "Sen menom láska",
          slug: "sen-menom-laska",
          image: "produkty/limitovane_senMenomLaska.jpg",
          descriptions: [
            "limitovaná kniha poézie",
            "hodvábna šatka s dielom M. Augustína",
            "certifikát vlastníctva",
            "300€ + poštovné",
            "nedostupné",
          ],
        },
      ],
    },
  };
  let gg = [];
  Object.keys(products).forEach(function (key, index) {
    products[key].items.map((item) =>
      gg.push({ params: { type: products[key].slug, prodname: item.slug } })
    );
  });

  return gg;
}

let currentType = null;
Object.keys(products).forEach(function (key) {
  if (products[key].slug == prodtype) {
    currentType = key;
  }
});

currentType = products[currentType];

var currentProduct = currentType.items.find((el) => el.slug == prodname);

var orderOfProduct = currentType.items.indexOf(currentProduct);
const nextLink =
  "/" +
  currentType.slug +
  "/" +
  currentType.items[(orderOfProduct + 1) % currentType.items.length].slug;
---

<html lang="en">
  <head>
    <MainHead
      title={currentProduct.title}
      description={"Dielo Martina Augustína" + currentProduct.descriptions[0]}
    />
  </head>

  <body>
    <div class="md:flex">
      <NavDesktop selectedMenu="novinky" />
      <NavMobile selectedMenu="novinky" isFixed={false} />
      <main class="w-full md:w-[80vw] h-full md:pt-20" id="novinky">
        <div class="container mx-auto px-4 flex flex-col pb-4">
          <div
            class="flex flex-col lg:flex-row md:gap-20 justify-start md:justify-between"
          >
            <div class="w-full flex-1">
              <div class="flex justify-between">
                <a href="/#novinky" class="flex align-middle">
                  <svg
                    class="h-10 py-2"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="#6B7280"
                  >
                    <path
                      d="M13.83 19a1 1 0 0 1-.78-.37l-4.83-6a1 1 0 0 1 0-1.27l5-6a1 1 0 0 1 1.54 1.28L10.29 12l4.32 5.36a1 1 0 0 1-.78 1.64z"
                    ></path>
                  </svg>
                  <div class="flex justify-center flex-col">
                    <div class="flex">
                      <h2 class="text-gray-500 font-bold text-xl">
                        {currentType.title}
                      </h2>
                      <p class="ml-2 text-gray-500 text-sm my-auto">
                        {
                          currentType.items.length > 1 && (
                            <span>
                              {" "}
                              | produkt {orderOfProduct + 1} /
                              {currentType.items.length}
                            </span>
                          )
                        }
                      </p>
                    </div>
                  </div>
                </a>
                {
                  currentType.items.length > 1 && (
                    <a href={nextLink} class="text-sm text-gray-500 my-auto">
                      nasledujúci
                    </a>
                  )
                }
              </div>
              <div
                class="img-container w-full relative overflow-hidden transition-all duration-500"
              >
                <img
                  class="w-full object-cover active"
                  src={"/assets/" + currentProduct.image}
                  alt={currentProduct.title}
                  id="prod-img"
                  data-alt={"/assets/" + currentProduct.altImage}
                  data-orig={"/assets/" + currentProduct.image}
                />

                <!-- {
                  currentProduct.altImage && (
                    <img
                      class="w-full md:h-[750px] object-cover absolute-top-0"
                      src={"/assets/" + currentProduct.altImage}
                      alt={currentProduct.title}
                      id="alt-img"
                    />
                  )
                } -->
              </div>

              {
                currentProduct.altImage && (
                  <p
                    class="text-gray-500 pt-2 justify-end pr-32 cursor-pointer"
                    id="next-img"
                  >
                    ďalší obrázok
                  </p>
                )
              }
            </div>

            <div class="w-full flex-1 mt-4">
              <h1 class="text-xl font-medium">
                {currentProduct.title.toUpperCase()}
              </h1>
              {
                currentProduct.author && (
                  <p class="text-gray-500 my-4">
                    Autori: {currentProduct.author}
                  </p>
                )
              }

              <div class="description">
                {
                  currentProduct.descriptions.map((description) => (
                    <p class="text-gray-500 my-4">
                      <span set:html={description} />
                    </p>
                  ))
                }
              </div>

              <p class="text-gray-500 my-4">
                Objednávku pošlite mailom na
                <a href="mailto:vena@nextra.sk" class="font-bold"
                  >vena@nextra.sk</a
                >
              </p>

              <a
                href="mailto:vena@nextra.sk"
                class="border py-1 px-3 border-gray-500 text-gray-500"
                >kontaktovať</a
              >
              <!--          <p class="text-gray-500 text-sm">{{ photo.date }}</p>-->
              <!--          <p class="text-gray-500 text-sm">{{ photo.location }}</p>-->
              <!--          <p class="text-gray-500 text-sm">{{ photo.description }}</p>-->
            </div>
          </div>

          <!-- show other product from same category -->
          {
            currentType.items.length > 1 && (
              <div class="mt-12 md:mt-40 max-w-4xl">
                <h3 class="font-semibold text-gray-500">Ostatné produkty</h3>

                <div class="grid grid-cols-2 md:grid-cols-4 justify-between gap-2 md:gap-8">
                  {currentType.items.map((item) => (
                    <a
                      href={"/" + currentType.slug + "/" + item.slug}
                      class=" py-2"
                    >
                      <img
                        class="w-full translate-y-0 aspect-square"
                        src={"/assets/" + item.image}
                        alt={item.title}
                      />
                      <p class="text-gray-500 text-sm pt-2">
                        <span class="font-semibold">{item.title}</span>
                        <br />
                        {item.author}
                      </p>
                    </a>
                  ))}
                </div>
              </div>
            )
          }

          <Kontakt />
        </div>
      </main>
    </div>
    <style>
      body {
        font-family: "Neue Haas Grotesk Display Pro", sans-serif;
      }

      img {
        transform: translateY(-120%);
        transition: all 1s ease-in-out;
        animation-delay: 0.5s;
      }

      img.active {
        transform: translateY(0);
      }
    </style>

    <script>
      let imageIndex = 0;
      if (document.getElementById("next-img")) {
        document.getElementById("next-img").onclick = function () {
          let image = document.getElementById("prod-img") as HTMLImageElement;
          let imageContainer = document.querySelector(
            ".img-container"
          ) as HTMLDivElement;

          imageIndex = (imageIndex + 1) % 2;
          image.classList.toggle("active");
          setTimeout(() => {
            image.src =
              imageIndex == 0
                ? image.getAttribute("data-orig")
                : image.getAttribute("data-alt");
            image.classList.toggle("active");
            image.onload = function () {
              imageContainer.style.height = image.clientHeight + "px";
            };
          }, 500);
        };
      }
    </script>
  </body>
</html>
